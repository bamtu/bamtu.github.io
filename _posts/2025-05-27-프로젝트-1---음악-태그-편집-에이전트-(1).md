---
layout: post
title:  "프로젝트 1 - 음악 태그 편집 에이전트 (2)"
date:   2025-05-27 21:50:08 +0900
categories: AIagent 프로젝트1
---

## 문제 인식
---
수 천개의 음원 파일을 가져올 때, 음원 파일이 너무 많아 token limit 제한에 걸려 에러가 나온다. 

![](../assets/20250527222015.png)

-> token limit에 도달함.

## 문제 해결 방안
---
RAG를 이용하여 음원파일의 tag 정보를 가져오고, 텍스트를 분할하고, 임베딩하여, 벡터 데이터베이스에 저장한다. 이를 통해 input token의 개수를 줄이고, 수천 개의 오디오 파일의 메타데이터를 효율적으로 가져와 성능을 향상시킨다.

![alt text](../assets/image(1).png)

예시 데이터들은 다음과 같다. 
```text
filename: song1.mp3, title: Love Story, artist: Taylor Swift, genre: Country, year: 2008, track: 1, comment: Classic hit, albumartist: Taylor Swift, composer: Taylor Swift \n\n
filename: song2.mp3, title: Blank Space, artist: Taylor Swift, genre: Pop, year: 2014, track: 2, comment: Billboard no.1, albumartist: Taylor Swift, composer: Max Martin \n\n
filename: song3.mp3, title: Bohemian Rhapsody, artist: Queen, genre: Rock, year: 1975, track: 1, comment: Legendary song, albumartist: Queen, composer: Freddie Mercury \n\n
...
```

파일이름과 메타 데이터들을 같이 1 chunk로 나눌 예정이다. 의미 단위(=각 음악 파일 하나)로 나누어 저장한다.

이렇게 되면 임베딩 처리 시 의미 단위로 나뉘게 된다. (곡 하나 = 하나의 벡터)
eg.
```text
filename: song1.mp3, title: Love Story, artist: Taylor Swift, genre: Country, year: 2008, track: 1, comment: Classic hit, albumartist: Taylor Swift, composer: Taylor Swift -> 1 chunk
filename: song2.mp3, title: Blank Space, artist: Taylor Swift, genre: Pop, year: 2014, track: 2, comment: Billboard no.1, albumartist: Taylor Swift, composer: Max Martin -> 1 chunk
filename: song3.mp3, title: Bohemian Rhapsody, artist: Queen, genre: Rock, year: 1975, track: 1, comment: Legendary song, albumartist: Queen, composer: Freddie Mercury -> 1 chunk
```
     
